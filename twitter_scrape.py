import tweepy
import json
import threading
from pymongo import MongoClient
from threading import Thread
import re
import signal


### Twitter API credentials
auth = tweepy.OAuthHandler('KEY_01', 'KEY_02')
auth.set_access_token('TOKEN_01', 'TOKEN_02')

### Unicode values for all emoji
emoji_list_unicode = [u"\U0001F98F",	u"\U0001F356",
u"\U0001F949",	u"\U0001F46F",
u"\U0001F98C",	u"\U0001F40A",
u"\U0001F45E",	u"\U0001F44A",
u"\U0001F195",	u"\U0001F3C5",
u"\U0001F1F1",	u"\U0001F6D0",
u"\U0001F930",	u"\U00002757",
u"\U0001F6D1",	u"\U0001F320",
u"\U00002665",	u"\U00002602",
u"\U0001F50D",	u"\U0001F3AE",
u"\U0001F5FF",	u"\U000026F3",
u"\U0001F52A",	u"\U00002626",
u"\U000023E9",	u"\U000023F1",
u"\U0001F432",	u"\U0001F41B",
u"\U0001F95D",	u"\U0001F3E2",
u"\U0001F47C",	u"\U0001F340",
u"\U00002B1B",	u"\U0001F427",
u"\U0001F38D",	u"\U0001F68D",
u"\U0001F404",	u"\U0001F32C",
u"\U0001F1F5",	u"\U000000AE",
u"\U0000261D",	u"\U0001F534",
u"\U0001F590",	u"\U0001F623",
u"\U0001F36E",	u"\U0001F413",
u"\U0001F4FB",	u"\U0001F517",
u"\U0001F1FD",	u"\U0001F474",
u"\U0001F69D",	u"\U0001F1FB",
u"\U0001F392",	u"\U0001F91B",
u"\U0001F333",	u"\U0001F91A",
u"\U0001F3D7",	u"\U00002649",
u"\U0001F46C",	u"\U0001F63B",
u"\U0001F4EA",	u"\U0001F4A3",
u"\U0001F1F4",	u"\U0001F62F",
u"\U0001F1FC",	u"\U0001F552",
u"\U0001F199",	u"\U0001F1F3",
u"\U0001F4F4",	u"\U0001F452",
u"\U0001F457",	u"\U0001F3AB",
u"\U0001F94B",	u"\U0000264C",
u"\U0001F373",	u"\U0001F483",
u"\U0001F3A0",	u"\U0001F6C0",
u"\U0001F4B2",	u"\U0001F447",
u"\U0001F526",	u"\U0001F39F",
u"\U0001F566",	u"\U000025C0",
u"\U0001F40D",	u"\U0001F938",
u"\U0000264D",	u"\U0001F63F",
u"\U0001F532",	u"\U0001F3B0",
u"\U0001F630",	u"\U0001F494",
u"\U0001F955",	u"\U0001F3E8",
u"\U0001F42C",	u"\U000025FB",
u"\U000023CF",	u"\U0001F635",
u"\U0001F3BB",	u"\U0001F345",
u"\U0001F642",	u"\U0001F3C9",
u"\U0001F497",	u"\U0001F945",
u"\U0001F681",	u"\U0001F236",
u"\U0001F47F",	u"\U0001F4D2",
u"\U0001F4B5",	u"\U0001F4BD",
u"\U0001F4A7",	u"\U0001F40E",
u"\U0001F6B4",	u"\U0001F6B2",
u"\U0001F40C",	u"\U0001F353",
u"\U0001F944",	u"\U0001F396",
u"\U0001F4D8",	u"\U0001F6BB",
u"\U0001F36B",	u"\U0001F519",
u"\U0001F692",	u"\U0001F377",
u"\U0001F1EB",	u"\U0001F3E3",
u"\U0001F6B7",	u"\U0001F465",
u"\U0001F4AE",	u"\U0001F93E",
u"\U0001F4CC",	u"\U0001F948",
u"\U00002934",	u"\U0001F3E1",
u"\U000023F8",	u"\U0001F3EE",
u"\U0001F3CA",	u"\U0001F6B1",
u"\U0001F3EF",	u"\U0001F49E",
u"\U0001F1EC",	u"\U0000231B",
u"\U0001F416",	u"\U0001F60C",
u"\U0001F498",	u"\U0001F91D",
u"\U0001F525",	u"\U0000267B",
u"\U0001F366",	u"\U0000274C",
u"\U0001F476",	u"\U0001F4CA",
u"\U0001F390",	u"\U0001F170",
u"\U0001F49D",	u"\U000026B1",
u"\U0001F3B6",	u"\U0001F3E7",
u"\U0000203C",	u"\U0001F250",
u"\U0001F34A",	u"\U0001F6E3",
u"\U0001F37C",	u"\U00003299",
u"\U0001F3AA",	u"\U0001F6A9",
u"\U00002935",	u"\U0001F3A1",
u"\U000026F9",	u"\U00000032",
u"\U0001F4B0",	u"\U0001F4A2",
u"\U0001F49A",	u"\U0001F437",
u"\U0001F49B",	u"\U0001F484",
u"\U0001F41D",	u"\U0001F4E8",
u"\U0001F46A",	u"\U0001F6A7",
u"\U0001F68B",	u"\U0001F558",
u"\U00002754",	u"\U0001F1FA",
u"\U0001F685",	u"\U0001F3AF",
u"\U0000267F",	u"\U0001F911",
u"\U0001F4B6",	u"\U0001F1F7",
u"\U000026A0",	u"\U0001F6AC",
u"\U0001F197",	u"\U0001F645",
u"\U0001F950",	u"\U0001F385",
u"\U0001F6B0",	u"\U0001F4E4",
u"\U0001F4AC",	u"\U0001F52C", u"\U0001F3F0",	u"\U0001F528",
u"\U0001F32A",	u"\U0001F51E",
u"\U0001F303",	u"\U0001F3CE",
u"\U0001F486",	u"\U0001F5D3",
u"\U0001F629",	u"\U0001F98D",
u"\U0001F423",	u"\U0001F527",
u"\U0001F3FA",	u"\U0001F4FC",
u"\U00002764",	u"\U0001F64F",
u"\U000026F8",	u"\U0001F45A",
u"\U00000033",	u"\U0001F378",
u"\U0001F6BD",	u"\U0001F4C5",
u"\U0001F556",	u"\U00002697",
u"\U000026F5",	u"\U0001F460",
u"\U0001F4CF",	u"\U0001F95A",
u"\U0001F53A",	u"\U0001F3F7",
u"\U0001F4D1",	u"\U0001F6BF",
u"\U0001F6AB",	u"\U0001F61F",
u"\U0001F4AF",	u"\U0001F501",
u"\U0001F234",	u"\U00000031",
u"\U0001F628",	u"\U0001F311",
u"\U0001F61B",	u"\U0001F563",
u"\U0001F69E",	u"\U0001F414",
u"\U0001F33C",	u"\U0001F4AB",
u"\U0001F4B1",	u"\U0001F567",
u"\U0001F438",	u"\U0001F3C4",
u"\U000023F3",	u"\U0001F407",
u"\U0001F380",	u"\U0001F368",
u"\U0001F5F3",	u"\U0001F17F",
u"\U0001F419",	u"\U000026BE",
u"\U0001F611",	u"\U0001F18E",
u"\U0001F4A4",	u"\U0001F587",
u"\U0001F196",	u"\U0001F330",
u"\U0001F622",	u"\U0001F618",
u"\U0001F57A",	u"\U0001F910",
u"\U0001F463",	u"\U0001F1F2",
u"\U0001F459",	u"\U0001F564",
u"\U00002601",	u"\U00002716",
u"\U00002B06",	u"\U0001F35C",
u"\U0001F620",	u"\U0001F633",
u"\U0001F920",	u"\U0001F644",
u"\U0001F481",	u"\U0001F6F3",
u"\U0001F32B",	u"\U0001F350",
u"\U0001F4F6",	u"\U0001F473",
u"\U0001F537",	u"\U00002709",
u"\U0001F53C",	u"\U0001F3B1",
u"\U0001F468",	u"\U0000231A",
u"\U00002650",	u"\U0001F555",
u"\U00002639",	u"\U000026F1",
u"\U0001F3B3",	u"\U0001F399",
u"\U0001F232",	u"\U0001F3BE",
u"\U0001F201",	u"\U0001F4C8",
u"\U0001F3BD",	u"\U0001F424",
u"\U0001F39E",	u"\U0001F409",
u"\U00002623",	u"\U0001F305",
u"\U0001F559",	u"\U0001F491",
u"\U000026F4",	u"\U0001F3CF",
u"\U0001F6C2",	u"\U0001F58D",
u"\U0001F3CD",	u"\U0001F60B",
u"\U0001F4A5",	u"\U0001F606",
u"\U0001F981",	u"\U0001F441",
u"\U0001F6A6",	u"\U0001F6CB",
u"\U000026BD",	u"\U000023EE",
u"\U0001F6C1",	u"\U00002714",
u"\U0001F4B8",	u"\U00000038",
u"\U000025FC",	u"\U0001F991",
u"\U0001F621",	u"\U0001F6B3",
u"\U0001F612",	u"\U0001F467",
u"\U0001F301",	u"\U0001F32D",
u"\U000026A1",	u"\U0001F921",
u"\U0001F505",	u"\U0001F48F",
u"\U0001F95E",	u"\U000026EA",
u"\U000026D3",	u"\U0001F33B",
u"\U0001F64C",	u"\U0001F337",
u"\U00002604",	u"\U00002663",
u"\U00002648",	u"\U0001F699",
u"\U0001F600",	u"\U0001F5B2",
u"\U0001F408",	u"\U0001F302",
u"\U0001F4BE",	u"\U00002753",
u"\U0001F383",	u"\U000026AB",
u"\U0001F251",	u"\U0001F565",
u"\U0001F41A",	u"\U0001F690",
u"\U0001F4DC",	u"\U0001F3A3",
u"\U00002615",	u"\U0001F6BC",
u"\U0001F514",	u"\U0001F40F",
u"\U0001F4FA",	u"\U0001F63E",
u"\U0001F549",	u"\U00002B05",
u"\U000026FD",	u"\U000021A9",
u"\U0001F504",	u"\U0001F643",
u"\U0001F397",	u"\U0001F521",
u"\U0001F435",	u"\U00002694",
u"\U0001F450",	u"\U0001F348",
u"\U0001F3E0",	u"\U0001F958",
u"\U0001F6F0",	u"\U0001F354",
u"\U0001F6C4",	u"\U0001F54C",
u"\U0001F52F",	u"\U0001F51C",
u"\U0001F524",	u"\U0001F442",
u"\U0001F479",	u"\U000021AA",
u"\U0001F308",	u"\U0001F454",
u"\U0001F698",	u"\U0001F5E8",
u"\U0001F513",	u"\U0001F3A2", u"\U0001F609",	u"\U0001F646",
u"\U0001F411",	u"\U000026B0",
u"\U0001F3CB",	u"\U0001F44C",
u"\U0001F696",	u"\U0001F3D4",
u"\U0001F4D9",	u"\U0001F687",
u"\U0001F410",	u"\U000023ED",
u"\U0001F37D",	u"\U0001F69C",
u"\U0001F6F5",	u"\U000026F2",
u"\U0001F6AA",	u"\U0001F695",
u"\U0001F235",	u"\U0001F3B2",
u"\U0001F506",	u"\U0000264F",
u"\U0001F62C",	u"\U0001F507",
u"\U0000263A",	u"\U0001F3BF",
u"\U0001F55B",	u"\U0001F3AD",
u"\U00002668",	u"\U0001F381",
u"\U000024C2",	u"\U0001F44E",
u"\U0001F4CB",	u"\U0001F4F3",
u"\U0001F538",	u"\U0001F6A5",
u"\U0001F35D",	u"\U00002705",
u"\U0001F493",	u"\U0001F516",
u"\U0001F6F4",	u"\U000025AA",
u"\U0001F6EB",	u"\U0001F918",
u"\U0001F58C",	u"\U0001F489",
u"\U0000264B",	u"\U00002B07",
u"\U0001F418",	u"\U0001F446",
u"\U0001F60A",	u"\U0001F986",
u"\U0001F91E",	u"\U0001F680",
u"\U0001F30C",	u"\U0001F562",
u"\U0001F4D0",	u"\U000023F2",
u"\U0001F95B",	u"\U0001F4EC",
u"\U0001F327",	u"\U0001F919",
u"\U0001F38E",	u"\U0001F5C4",
u"\U0001F64E",	u"\U0001F51A",
u"\U0001F954",	u"\U0001F488",
u"\U0001F47A",	u"\U0001F328",
u"\U0001F436",	u"\U0001F3D2",
u"\U0001F3D5",	u"\U0001F376",
u"\U0001F926",	u"\U0001F3C8",
u"\U00000034",	u"\U0001F343",
u"\U0001F4CE",	u"\U0001F367",
u"\U0001F43E",	u"\U0001F34F",
u"\U0001F38C",	u"\U00002049",
u"\U0001F3C0",	u"\U0001F36D",
u"\U000026E9",	u"\U0001F485",
u"\U0001F682",	u"\U0001F300",
u"\U0001F957",	u"\U0001F4AA",
u"\U0001F61C",	u"\U0001F374",
u"\U0001F5B1",	u"\U0001F1EE",
u"\U0001F943",	u"\U0001F956",
u"\U0001F365",	u"\U0001F495",
u"\U0001F686",	u"\U0001F43C",
u"\U0001F34D",	u"\U000026CF",
u"\U0001F379",	u"\U00002653",
u"\U0001F604",	u"\U0001F325",
u"\U0000264A",	u"\U0001F637",
u"\U00002620",	u"\U0001F48E",
u"\U0001F422",	u"\U0001F42D",
u"\U0001F69F",	u"\U0001F5FE",
u"\U0001F63C",	u"\U0001F355",
u"\U0001F3EB",	u"\U0001F359",
u"\U0001F95C",	u"\U0001F50B",
u"\U0001F46E",	u"\U0001F4FD",
u"\U0001F693",	u"\U0001F4EE",
u"\U00002197",	u"\U0001F198",
u"\U0001F639",	u"\U0001F4FF",
u"\U0001F5A5",	u"\U0001F312",
u"\U0001F4E7",	u"\U0001F6C3",
u"\U00002744",	u"\U0001F48A",
u"\U0001F4DD",	u"\U0001F51B",
u"\U0001F3EA",	u"\U0001F531",
u"\U0001F402",	u"\U0001F522",
u"\U0001F30A",	u"\U0001F1E7",
u"\U0001F52B",	u"\U0001F4A0",
u"\U0001F523",	u"\U0001F445",
u"\U0001F518",	u"\U0000200D",
u"\U0001F578",	u"\U0001F603",
u"\U0001F38B",	u"\U0001F420",
u"\U0001F21A",	u"\U0001F344",
u"\U0001F412",	u"\U00002666",
u"\U0001F49C",	u"\U0001F401",
u"\U0001F608",	u"\U0001F4ED",
u"\U0001F6CF",	u"\U0001F1F0",
u"\U0001F47B",	u"\U0001F321",
u"\U0001F554",	u"\U0001F988",
u"\U0001F6E2",	u"\U0001F3DE",
u"\U0001F937",	u"\U000023EA",
u"\U0001F363",	u"\U0001F3A7",
u"\U0001F914",	u"\U0001F36C",
u"\U0001F45C",	u"\U00003030",
u"\U0001F4B3",	u"\U0001F233",
u"\U0001F530",	u"\U0001F35E",
u"\U0001F421",	u"\U0001F3A6",
u"\U0001F557",	u"\U0001F610",
u"\U0001F191",	u"\U0001F315",
u"\U0001F40B",	u"\U0001F5FA",
u"\U0001F940",	u"\U0001F638",
u"\U0001F4A8",	u"\U0001F3B7",
u"\U0001F48D",	u"\U0001F94A",
u"\U000026C4",	u"\U0001F6A4",
u"\U0001F171",	u"\U00002638", u"\U0001F3F3",	u"\U0001F6C5",
u"\U0001F4D3",	u"\U0001F426",
u"\U00002796",	u"\U0001F37B",
u"\U0001F50F",	u"\U000023EF",
u"\U0001F560",	u"\U0001F417",
u"\U00000039",	u"\U0001F54A",
u"\U0001F6E1",	u"\U0001F691",
u"\U0001F64B",	u"\U0001F601",
u"\U0001F63A",	u"\U0001F38F",
u"\U0001F529",	u"\U0001F362",
u"\U00002708",	u"\U0001F31A",
u"\U0001F313",	u"\U0001F3AC",
u"\U00000035",	u"\U0001F42A",
u"\U000026D1",	u"\U0001F3D3",
u"\U0001F6B8",	u"\U0001F351",
u"\U0001F6AE",	u"\U0001F5BC",
u"\U0001F43D",	u"\U0001F579",
u"\U00002721",	u"\U0001F615",
u"\U0001F924",	u"\U0001F369",
u"\U0000269C",	u"\U0001F45D",
u"\U0001F3DB",	u"\U0001F461",
u"\U0001F6CC",	u"\U0001F37F",
u"\U0001F428",	u"\U0000274E",
u"\U0001F3A5",	u"\U0001F480",
u"\U0001F3C1",	u"\U0001F60D",
u"\U0001F3F4",	u"\U0001F636",
u"\U0001F444",	u"\U000023F9",
u"\U0001F5DD",	u"\U0001F4E1",
u"\U0001F5C3",	u"\U0001F317",
u"\U0001F4E5",	u"\U0001F64A",
u"\U0001F37A",	u"\U0001F990",
u"\U0001F31E",	u"\U0001F3D0",
u"\U0001F35A",	u"\U0001F626",
u"\U0001F625",	u"\U0001F941",
u"\U0001F915",	u"\U0001F3FD",
u"\U0001F3D8",	u"\U0000262E",
u"\U0001F391",	u"\U0001F434",
u"\U0001F52E",	u"\U000026AA",
u"\U0001F30F",	u"\U0001F983",
u"\U0001F430",	u"\U0001F5DC",
u"\U0001F4E2",	u"\U0001F5FC",
u"\U0001F3B4",	u"\U00002194",
u"\U0001F613",	u"\U0001F347",
u"\U0001F36A",	u"\U0001F55E",
u"\U0001F939",	u"\U0000303D",
u"\U0001F470",	u"\U0001F6E5",
u"\U0001F60F",	u"\U0001F482",
u"\U0001F471",	u"\U0001F306",
u"\U0001F1ED",	u"\U0001F364",
u"\U0001F694",	u"\U0001F43B",
u"\U0001F499",	u"\U0001F4E3",
u"\U0001F536",	u"\U0001F68A",
u"\U000023EC",	u"\U00002600",
u"\U0001F55D",	u"\U0001F6AD",
u"\U0001F93C",	u"\U0001F3FE",
u"\U0001F912",	u"\U0001F93A",
u"\U0001F575",	u"\U0001F239",
u"\U0001F3C3",	u"\U0001F329",
u"\U00002196",	u"\U0001F403",
u"\U0001F19A",	u"\U0001F464",
u"\U0001F913",	u"\U0001F4DE",
u"\U0001F384",	u"\U0001F5D2",
u"\U0001F453",	u"\U0001F439",
u"\U0001F934",	u"\U0001F6EC",
u"\U0001F561",	u"\U0001F39B",
u"\U0001F387",	u"\U00002763",
u"\U0001F50E",	u"\U0001F577",
u"\U0001F4C6",	u"\U0001F4EF",
u"\U0001F63D",	u"\U0001F3E9",
u"\U00002328",	u"\U0001F4DF",
u"\U0001F400",	u"\U00002660",
u"\U0001F697",	u"\U0001F4BB",
u"\U00002B50",	u"\U0001F490",
u"\U0001F472",	u"\U0001F50C",
u"\U0001F6AF",	u"\U0001F3B5",
u"\U0000270F",	u"\U0001F4A1",
u"\U0001F5EF",	u"\U0000262A",
u"\U0001F60E",	u"\U0001F6A3",
u"\U0001F431",	u"\U0001F1F6",
u"\U0001F44D",	u"\U000026FA",
u"\U0001F3C2",	u"\U00002728",
u"\U0001F393",	u"\U0001F415",
u"\U0001F314",	u"\U0001F4BC",
u"\U0001F5A8",	u"\U0001F508",
u"\U0001F689",	u"\U0001F41F",
u"\U0001F48B",	u"\U0001F641",
u"\U0001F984",	u"\U0001F49F",
u"\U0001F492",	u"\U0001F553",
u"\U0001F927",	u"\U0001F32E",
u"\U0001F388",	u"\U0000262F",
u"\U0001F595",	u"\U0001F202",
u"\U0001F947",	u"\U00003297",
u"\U0001F4C0",	u"\U0001F3A9",
u"\U0001F58A",	u"\U0001F942",
u"\U0001F4DB",	u"\U0001F38A",
u"\U00002603",	u"\U00002693",
u"\U000023EB",	u"\U0001F443",
u"\U0001F4BA",	u"\U0000264E",
u"\U0001F375",	u"\U0001F573",
u"\U0001F34C",	u"\U0001F34E", u"\U0001F54B",u"\U000026C8",
u"\U0001F324",	u"\U0001F53D",
u"\U0001F456",	u"\U0001F3A4",
u"\U0001F36F",	u"\U0001F53B",
u"\U0001F596",	u"\U0001F47D",
u"\U0001F487",	u"\U0001F6BA",
u"\U0001F640",	u"\U0001F933",
u"\U0001F91C",	u"\U0001F627",
u"\U0001F370",	u"\U0001F4B4",
u"\U0001F6A2",	u"\U0001F4A6",
u"\U0001F3FB",	u"\U00000030",
u"\U000023F0",	u"\U0001F478",
u"\U0000260E",	u"\U0001F619",
u"\U000020E3",	u"\U0001F48C",
u"\U0001F535",	u"\U0001F987",
u"\U0001F649",	u"\U0001F922",
u"\U0001F605",	u"\U0001F68F",
u"\U00002614",	u"\U0001F425",
u"\U0001F5D1",	u"\U0001F4D4",
u"\U0001F4AD",	u"\U00002733",
u"\U0001F982",	u"\U000000A9",
u"\U0001F35B",	u"\U0001F32F",
u"\U0001F45F",	u"\U00002139",
u"\U00002692",	u"\U0001F55C",
u"\U0001F46B",	u"\U0001F30E",
u"\U0001F316",	u"\U0001F3DC",
u"\U0001F6A8",	u"\U0001F683",
u"\U0001F4F0",	u"\U0001F4DA",
u"\U00002795",	u"\U0001F61D",
u"\U0001F42F",	u"\U0001F574",
u"\U0001F6BE",	u"\U0001F352",
u"\U0001F31D",	u"\U0001F357",
u"\U0001F3D6",	u"\U0001F6B6",
u"\U00002195",	u"\U0001F361",
u"\U0001F466",	u"\U0001F5FD",
u"\U0001F4A9",	u"\U0001F6E4",
u"\U0001F309",	u"\U0001F50A",
u"\U0001F1EF",	u"\U000026CE",
u"\U0001F31B",	u"\U0001F503",
u"\U0001F307",	u"\U0001F52D",
u"\U0001F634",	u"\U0001F318",
u"\U0001F69B",	u"\U0001F4F9",
u"\U0001F602",	u"\U0001F3F8",
u"\U0001F512",	u"\U0001F496",
u"\U0001F510",	u"\U0001F3A8",
u"\U0001F33E",	u"\U0001F433",
u"\U0001F54E",	u"\U00002B55",
u"\U0001F194",	u"\U0001F193",
u"\U0001F533",	u"\U0001F51D",
u"\U0001F4E0",	u"\U0001F1E6",
u"\U0001F326",	u"\U0001F54D",
u"\U00002696",	u"\U00002198",
u"\U0001F98B",	u"\U0001F346",
u"\U0001F5FB",	u"\U00002122",
u"\U0001F1FF",	u"\U0001F440",
u"\U0000270A",	u"\U0001F6CD",
u"\U0001F93D",	u"\U0001F951",
u"\U0001F6CE",	u"\U0001F406",
u"\U0001F30D",	u"\U0001F5E3",
u"\U0001F3C7",	u"\U0001F451",
u"\U0001F69A",	u"\U0001F37E",
u"\U0001F952",	u"\U000025FE",
u"\U0001F3FC",	u"\U0001F1FE",
u"\U0001F616",	u"\U0001F58B",
u"\U0001F4C4",	u"\U0000269B",
u"\U000026D4",	u"\U0001F68E",
u"\U0001F4B9",	u"\U00002618",
u"\U0001F5E1",	u"\U0001F55F",
u"\U00002652",	u"\U0001F310",
u"\U0001F469",	u"\U0001F3E4",
u"\U000026C5",	u"\U0001F4C2",
u"\U0001F389",	u"\U00002702",
u"\U0000270B",	u"\U00002199",
u"\U0001F62D",	u"\U0001F520",
u"\U000026F7",	u"\U0001F1E8",
u"\U0001F4C9",	u"\U0001F3E5",
u"\U0001F4B7",	u"\U0001F6B9",
u"\U0001F42E",	u"\U0001F4F7",
u"\U0001F1EA",	u"\U0001F33A",
u"\U0001F607",	u"\U0001F39A",
u"\U0001F335",	u"\U0001F502",
u"\U0001F617",	u"\U0001F449",
u"\U0001F3E6",	u"\U0001F462",
u"\U0001F3CC",	u"\U0001F3DF",
u"\U0001F5DE",	u"\U00002699",
u"\U0001F51F",	u"\U00000037",
u"\U0001F515",	u"\U0001F539",
u"\U0001F45B",	u"\U0001F1E9",
u"\U0001F3BA",	u"\U0001F331",
u"\U0001F935",	u"\U0001F341",
u"\U0001F576",	u"\U0001F61E",
u"\U0001F3D9",	u"\U0001F917",
u"\U0001F4E6",	u"\U0001F44F",
u"\U0001F3BC",	u"\U0001F43F",
u"\U0001F46D",	u"\U0001F4C3",
u"\U0001F4EB",	u"\U0001F336",
u"\U0001F43A",	u"\U0001F4BF",
u"\U0001F3FF",	u"\U0001F33D"]


### Splits the unicode emoji list into blocks of 83 emoji to track at a time
### Twitter API has limits on the number of search terms
emoji_list = [emoji_list_unicode[i:i + 83] for i in range(0, len(emoji_list_unicode), 83)]


### Will listen to Twitter stream and output tweets to Mongo database
class CustomStreamListener(tweepy.StreamListener):
    def on_connect(self):
        """Called when the connection is made"""
        print("You're connected to the streaming server.")
    def on_error(self, status_code):
        if status_code == 420:
            return False
    def on_data(self,data):
        client = MongoClient('localhost', 27017)
        db = client.emojidb
        json_data = json.loads(data)
        db.emojitweets.insert(json_data)


### Register an handler for the timeout
def handler(signum, frame):
    print("Forever is over!")
    raise Exception("Whoops! Timed out.")


def start_stream(auth, track):
    stream_listener = CustomStreamListener()
    tweepy.Stream(auth=auth, listener=stream_listener(track)).filter(track=[track])


api = tweepy.API(auth)
stream_listener = CustomStreamListener()


def twitter_scrape(args):
        print('connected')
        stream = tweepy.Stream(auth = api.auth, listener = stream_listener)
        stream.filter(languages=["en"], track=args)
     
def print_end():
    print("all done!")



### Register the signal function handler
signal.signal(signal.SIGALRM, handler)


### Cycles through the list of emoji and tracks the contents of each list
### for 5 minutes, then goes to the next list
for lst in emoji_list:
    signal.alarm(300)
    try:
        twitter_scrape(lst)
    except: 
        print('next!')

